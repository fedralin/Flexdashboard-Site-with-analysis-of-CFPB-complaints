---
title: "Flexdashboard Site CFPB"
author: "Francesca Edralin"
date: "3/30/2021"
output: 
   flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: fill
    theme: cerulean
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(flexdashboard)
library(tidyverse)
library(lubridate)
library(janitor)
library(glue)
library(plotly)
library(DT)
library(kableExtra)
library(htmlwidgets)
library(htmltools)
library(readxl)

complaints <- "complaints.rds"

```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

Companies with Most Complaints
==============================================

```{r}


topcompanies

top10companies <- topcompanies %>%
  head(10)

top10companies

```


Breakdown of Company Responses
======================================

```{r}

responsesbreakdown <- complaints %>%
  group_by(company_response_to_consumer) %>%
  summarize(totalresponses = n()) %>%
  arrange(desc(totalresponses)) %>%
  head(5)
 
responsesbreakdown

Parts <- c('Closed with explanation','Closed with non-monetary relief', 'Closed with monetary relief', 'In progress', 'Untimely Response')
Responses <- c(354555, 20182, 10523,6660, 1129)
Totalresponses <- data.frame(Parts, Responses)

Responsesdonut <- Totalresponses %>% plot_ly(labels = ~Parts, values = ~Responses)

Responsesdonut <- Responsesdonut %>% add_pie(hole = 0.6)

Responsesdonut <- Responsesdonut %>% layout(
                  title = "Breakdown of Total Received Responses",  showlegend = F,
                  xaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE),
                  yaxis = list(showgrid = FALSE, zeroline = FALSE, showticklabels = FALSE))

Responsesdonut
```

Most Common Issues Reported
========================================
```{r}

topissues <- complaints %>%
  group_by(issue) %>%
  summarize(totalissues = n()) %>%
  arrange(desc(totalissues)) 

top10issues <- topissues %>%
  head(10)

top10issues

mostcommonissueschart <- top10issues %>%
    plot_ly(x = ~issue, y = ~totalissues, type = 'bar') %>% 
        layout(title = "Top 10 Most Commonly Reported Issues",
         xaxis = list(title = " "),
         yaxis = list (title = "Total Number Reported"))

mostcommonissueschart
```

